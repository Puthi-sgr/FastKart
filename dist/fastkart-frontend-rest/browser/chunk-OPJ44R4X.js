import{B as m,Df as _,E as d,Ef as x,Ff as I,Gf as L,Hd as j,Hf as R,If as U,Jf as $,Rb as c,Sb as w,Ub as h,a as y,b as S,cc as b,dd as p,h as o,rb as v,y as s}from"./chunk-HENG4I7O.js";var E=(()=>{let r=class r{constructor(e){this.http=e,this.skeletonLoader=!1}getOrders(e){return this.http.get(`${p.URL}/order`,{params:e})}viewOrder(e){return this.http.get(`${p.URL}/order/${e}`)}checkout(e){return this.http.post(`${p.URL}/checkout`,e)}placeOrder(e){return this.http.post(`${p.URL}/order`,e)}rePayment(e){return this.http.post(`${p.URL}/rePayment`,e)}orderTracking(e){return this.http.get(`${p.URL}/trackOrder`,{params:e})}downloadInvoice(e){let a={};return this.http.post(`${p.URL}/order/invoice`,e,{responseType:"blob"})}};r.\u0275fac=function(a){return new(a||r)(d(v))},r.\u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var l,i=(l=class{constructor(r,t,e){this.notificationService=r,this.router=t,this.orderService=e}static order(r){return r.order}static selectedOrder(r){return r.selectedOrder}static checkout(r){return r.checkout}getOrders(r,t){return this.orderService.getOrders(t?.payload).pipe(s({next:e=>{r.patchState({order:{data:e.data,total:e?.total?e?.total:e.data?.length}})},error:e=>{throw new Error(e?.error?.message)}}))}viewOrder(r,{id:t}){return this.orderService.skeletonLoader=!0,this.orderService.viewOrder(t).pipe(s({next:e=>{let a=r.getState();r.patchState(S(y({},a),{selectedOrder:e}))},error:e=>{throw new Error(e?.error?.message)},complete:()=>{this.orderService.skeletonLoader=!1}}))}checkout(r,t){return this.orderService.checkout(t?.payload).pipe(s({next:e=>{let a=r.getState();r.patchState(S(y({},a),{checkout:e}))},error:e=>{throw new Error(e?.error?.message)}}))}placeOrder(r,t){return this.orderService.placeOrder(t?.payload).pipe(s({next:e=>{(t.payload.payment_method=="cod"||t.payload.payment_method=="bank_transfer")&&!e.is_guest?this.router.navigateByUrl(`/account/order/details/${e.order_number}`):(t.payload.payment_method=="cod"||t.payload.payment_method=="bank_transfer")&&e.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:e.order_number,email_or_phone:t?.payload.email}}):window.open(e.url,"_self")},error:e=>{throw new Error(e?.error?.message)}}))}rePayment(r,t){return this.orderService.rePayment(t.payload).pipe(s({next:e=>{(t.payload.payment_method=="cod"||t.payload.payment_method=="bank_transfer")&&!e.is_guest?this.router.navigateByUrl(`/account/order/details/${e.order_number}`):(t.payload.payment_method=="cod"||t.payload.payment_method=="bank_transfer")&&e.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:e.order_number,email_or_phone:e.email}}):window.open(e.url,"_self")},error:e=>{throw new Error(e?.error?.message)}}))}orderTracking(r,t){return this.notificationService.notification=!1,this.orderService.orderTracking(t.payload).pipe(s({next:e=>{let a=r.getState();r.patchState(S(y({},a),{selectedOrder:e}))},error:e=>{throw new Error(e?.error?.message)}}))}downloadInvoice(r,t){return this.orderService.downloadInvoice(t.payload).pipe(s({next:e=>{let a=new Blob([e],{type:"pdf"}),k=window.URL.createObjectURL(a),g=document.createElement("a");g.href=k,g.download=`invoice-${t.payload.order_number}.pdf`,g.click(),window.URL.revokeObjectURL(k)},error:e=>{throw new Error(e?.error?.message)}}))}},l.\u0275fac=function(t){return new(t||l)(d(j),d(b),d(E))},l.\u0275prov=m({token:l,factory:l.\u0275fac}),l);o([c(_)],i.prototype,"getOrders",null);o([c(x)],i.prototype,"viewOrder",null);o([c(I)],i.prototype,"checkout",null);o([c(L)],i.prototype,"placeOrder",null);o([c(R)],i.prototype,"rePayment",null);o([c(U)],i.prototype,"orderTracking",null);o([c($)],i.prototype,"downloadInvoice",null);o([h()],i,"order",null);o([h()],i,"selectedOrder",null);o([h()],i,"checkout",null);i=o([w({name:"order",defaults:{order:{data:[],total:0},selectedOrder:null,checkout:null}})],i);var P=(()=>{let r=class r{constructor(e){this.payload=e}};r.type="[Order Status] Get";let n=r;return n})();var T=(()=>{let r=class r{constructor(e){this.http=e}getOrderStatus(e){return this.http.get(`${p.URL}/orderStatus`,{params:e})}};r.\u0275fac=function(a){return new(a||r)(d(v))},r.\u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var u,f=(u=class{constructor(r){this.orderStatusService=r}static orderStatus(r){return r.orderStatus}static orderStatuses(r){return r.orderStatus.data.map(t=>({label:t?.name,value:t?.id}))}static selectedOrderStatus(r){return r.selectedOrderStatus}getOrderStatus(r,t){return this.orderStatusService.getOrderStatus(t.payload).pipe(s({next:e=>{r.patchState({orderStatus:{data:e.data,total:e?.total?e?.total:e.data?.length}})},error:e=>{throw new Error(e?.error?.message)}}))}},u.\u0275fac=function(t){return new(t||u)(d(T))},u.\u0275prov=m({token:u,factory:u.\u0275fac}),u);o([c(P)],f.prototype,"getOrderStatus",null);o([h()],f,"orderStatus",null);o([h()],f,"orderStatuses",null);o([h()],f,"selectedOrderStatus",null);f=o([w({name:"orderStatus",defaults:{orderStatus:{data:[],total:0},selectedOrderStatus:null}})],f);export{i as a,P as b,f as c};
